D1=[   1,  1,  1, -1,  1,  1,  1, -1,  1,  1,  1, -1, -1, -1, -1,  1,  0,  0,  1,  1, -1,  1,  1,  1, -1,  1,  1,  1, -1,  1, -1, -1,  1, -1;
  1, -1,  1,  1,  1, -1,  1,  1,  1, -1,  1,  1, -1,  1, -1, -1,  0,  0,  1, -1, -1, -1,  1, -1, -1, -1,  1, -1, -1, -1, -1,  1,  1,  1;
  1,  1,  1, -1, -1, -1, -1,  1,  1,  1,  1, -1,  1,  1,  1, -1,  0,  0,  1,  1, -1,  1, -1, -1,  1, -1,  1,  1, -1,  1,  1,  1, -1,  1;
  1, -1,  1,  1, -1,  1, -1, -1,  1, -1,  1,  1,  1, -1,  1,  1,  0,  0,  1, -1, -1, -1, -1,  1,  1,  1,  1, -1, -1, -1,  1, -1, -1, -1
];
D2=[  1,  1,  1, -1,  1,  1,  1, -1, -1, -1, -1,  1,  1,  1,  1, -1,  0,  0,  1,  1, -1,  1,  1,  1, -1,  1, -1, -1,  1, -1,  1,  1, -1,  1;
  1, -1,  1,  1,  1, -1,  1,  1, -1,  1, -1, -1,  1, -1,  1,  1,  0,  0,  1, -1, -1, -1,  1, -1, -1, -1, -1,  1,  1,  1,  1, -1, -1, -1;
  1,  1,  1, -1, -1, -1, -1,  1, -1, -1, -1,  1, -1, -1, -1,  1,  0,  0,  1,  1, -1,  1, -1, -1,  1, -1, -1, -1,  1, -1, -1, -1,  1, -1;
  1, -1,  1,  1, -1,  1, -1, -1, -1,  1, -1, -1, -1,  1, -1, -1,  0,  0,  1, -1, -1, -1, -1,  1,  1,  1, -1,  1,  1,  1, -1,  1,  1,  1];
D3=[1,1,1,1,0,-1,-1,1,1;1,1,-1,-1,0,-1,-1,-1,-1;-1,1,-1,1,0,1,-1,-1,1;-1,1,1,-1,0,1,-1,1,-1];
D4=[-1,1,-1,1,0,1,-1,-1,1;-1,1,1,-1,0,1,-1,1,-1;1,1,1,1,0,-1,-1,1,1;1,1,-1,-1,0,-1,-1,-1,-1];
 D5=kron(D1,D4);
 tic
sym a;
h=zeros(1,9);
for i=1:9
f=D5(i,:);
a=length(f);
IAPR=zeros(1,1001);
z=0;
for t=0:0.001:1
  z=1000*t+1; 
   r = 0;
    for k = 0:1:a-1
   r=r+f(k+1)*exp(2*pi*k*sqrt(-1)*t);
    end
Pc = r*conj(r);

IAPR(round(z)) = Pc/(256);

end

papr_value=max(IAPR);
h(i)=papr_value;
end
disp("The PAPR of f is");
disp(max(h));

clear
